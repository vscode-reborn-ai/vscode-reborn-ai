/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/(function(){var R=["vs/code/browser/workbench/workbench","require","exports","vs/base/browser/browser","vs/base/browser/window","vs/base/common/buffer","vs/base/common/event","vs/base/common/lifecycle","vs/base/common/marshalling","vs/base/common/network","vs/base/common/path","vs/base/common/resources","vs/base/common/strings","vs/base/common/uri","vs/platform/product/common/product","vs/platform/window/common/window","vs/workbench/workbench.web.main"],I=function(l){for(var f=[],y=0,o=l.length;y<o;y++)f[y]=R[l[y]];return f},T=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};define(R[0],I([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),function(l,f,y,o,S,k,L,N,m,g,U,O,u,$,d,A){"use strict";Object.defineProperty(f,"__esModule",{value:!0}),f.LocalStorageSecretStorageProvider=void 0,$=T($);class H{async seal(e){return e}async unseal(e){return e}}var n;(function(i){i.ALGORITHM="AES-GCM",i[i.KEY_LENGTH=256]="KEY_LENGTH",i[i.IV_LENGTH=12]="IV_LENGTH"})(n||(n={}));class E{static supported(){return!!crypto.subtle}constructor(e){this.b=e}async seal(e){const t=o.$WR.crypto.getRandomValues(new Uint8Array(n.IV_LENGTH)),r=await o.$WR.crypto.subtle.generateKey({name:n.ALGORITHM,length:n.KEY_LENGTH},!0,["encrypt","decrypt"]),s=new Uint8Array(await o.$WR.crypto.subtle.exportKey("raw",r)),h=await this.c(s),a=new TextEncoder().encode(e),b=await o.$WR.crypto.subtle.encrypt({name:n.ALGORITHM,iv:t},h,a),p=new Uint8Array([...s,...t,...new Uint8Array(b)]);return(0,S.$9e)(S.$Oe.wrap(p))}async unseal(e){const t=(0,S.$8e)(e);if(t.byteLength<60)throw Error("Invalid length for the value for credentials.crypto");const r=n.KEY_LENGTH/8,s=t.slice(0,r),h=t.slice(r,r+n.IV_LENGTH),a=t.slice(r+n.IV_LENGTH),b=await this.c(s.buffer),p=await o.$WR.crypto.subtle.decrypt({name:n.ALGORITHM,iv:h.buffer},b,a.buffer);return new TextDecoder().decode(new Uint8Array(p))}async c(e){if(!e||e.byteLength!==n.KEY_LENGTH/8)throw Error("Invalid length for clientKey");const t=await this.d(),r=new Uint8Array(n.KEY_LENGTH/8);for(let s=0;s<r.byteLength;s++)r[s]=e[s]^t[s];return o.$WR.crypto.subtle.importKey("raw",r,{name:n.ALGORITHM,length:n.KEY_LENGTH},!0,["encrypt","decrypt"])}async d(){if(this.a)return this.a;let e=0,t;for(;e<=3;)try{const r=await fetch(this.b,{credentials:"include",method:"POST"});if(!r.ok)throw new Error(r.statusText);const s=new Uint8Array(await await r.arrayBuffer());if(s.byteLength!==n.KEY_LENGTH/8)throw Error(`The key retrieved by the server is not ${n.KEY_LENGTH} bit long.`);return this.a=s,this.a}catch(r){t=r,e++,await new Promise(s=>setTimeout(s,e*e*100))}throw t}}class w{constructor(e){this.c=e,this.a="secrets.provider",this.b=this.d(),this.type="persisted"}async d(){const e=this.f(),t=localStorage.getItem(this.a);if(t)try{const r=JSON.parse(await this.c.unseal(t));return{...e,...r}}catch(r){console.error("Failed to decrypt secrets from localStorage",r),localStorage.removeItem(this.a)}return e}f(){let e;const t=o.$WR.document.getElementById("vscode-workbench-auth-session"),r=t?t.getAttribute("data-settings"):void 0;if(r)try{e=JSON.parse(r)}catch{}if(!e)return{};const s={};if(s[`${$.default.urlProtocol}.loginAccount`]=JSON.stringify(e),e.providerId!=="github")return console.error(`Unexpected auth provider: ${e.providerId}. Expected 'github'.`),s;const h=JSON.stringify({extensionId:"vscode.github-authentication",key:"github.auth"});return s[h]=JSON.stringify(e.scopes.map(a=>({id:e.id,scopes:a,accessToken:e.accessToken}))),s}async get(e){return(await this.b)[e]}async set(e,t){const r=await this.b;r[e]=t,this.b=Promise.resolve(r),this.g()}async delete(e){const t=await this.b;delete t[e],this.b=Promise.resolve(t),this.g()}async g(){try{const e=await this.c.seal(JSON.stringify(await this.b));localStorage.setItem(this.a,e)}catch(e){console.error(e)}}}f.LocalStorageSecretStorageProvider=w;class v extends L.$Wc{static{this.a=0}static{this.b=["scheme","authority","path","query","fragment"]}constructor(e){super(),this.m=e,this.c=this.B(new k.$me),this.onCallback=this.c.event,this.f=new Set,this.g=Date.now(),this.h=void 0}create(e={}){const t=++v.a,r=[`vscode-reqid=${t}`];for(const s of v.b){const h=e[s];h&&r.push(`vscode-${s}=${encodeURIComponent(h)}`)}if(!(e.authority==="vscode.github-authentication"&&e.path==="/dummy")){const s=`vscode-web.url-callbacks[${t}]`;localStorage.removeItem(s),this.f.add(t),this.n()}return u.URI.parse(o.$WR.location.href).with({path:this.m,query:r.join("&")})}n(){if(this.j)return;const e=()=>this.s();o.$WR.addEventListener("storage",e),this.j={dispose:()=>o.$WR.removeEventListener("storage",e)}}r(){this.j?.dispose(),this.j=void 0}async s(){const e=Date.now()-this.g;e>1e3?this.t():this.h===void 0&&(this.h=setTimeout(()=>{this.h=void 0,this.t()},1e3-e))}t(){let e;for(const t of this.f){const r=`vscode-web.url-callbacks[${t}]`,s=localStorage.getItem(r);if(s!==null){try{this.c.fire(u.URI.revive(JSON.parse(s)))}catch(h){console.error(h)}e=e??new Set(this.f),e.delete(t),localStorage.removeItem(r)}}e&&(this.f=e,this.f.size===0&&this.r()),this.g=Date.now()}}class c{static{this.a="ew"}static{this.b="folder"}static{this.c="workspace"}static{this.d="payload"}static create(e){let t=!1,r,s=Object.create(null);return new URL(document.location.href).searchParams.forEach((a,b)=>{switch(b){case c.b:e.remoteAuthority&&a.startsWith(g.$ic.sep)?r={folderUri:u.URI.from({scheme:m.Schemas.vscodeRemote,path:a,authority:e.remoteAuthority})}:r={folderUri:u.URI.parse(a)},t=!0;break;case c.c:e.remoteAuthority&&a.startsWith(g.$ic.sep)?r={workspaceUri:u.URI.from({scheme:m.Schemas.vscodeRemote,path:a,authority:e.remoteAuthority})}:r={workspaceUri:u.URI.parse(a)},t=!0;break;case c.a:r=void 0,t=!0;break;case c.d:try{s=(0,N.$bi)(a)}catch(p){console.error(p)}break}}),t||(e.folderUri?r={folderUri:u.URI.revive(e.folderUri)}:e.workspaceUri&&(r={workspaceUri:u.URI.revive(e.workspaceUri)})),new c(r,s,e)}constructor(e,t,r){this.workspace=e,this.payload=t,this.f=r,this.trusted=!0}async open(e,t){if(t?.reuse&&!t.payload&&this.j(this.workspace,e))return!0;const r=this.g(e,t);if(r){if(t?.reuse)return o.$WR.location.href=r,!0;{let s;return(0,y.$dS)()?s=o.$WR.open(r,"_blank","toolbar=no"):s=o.$WR.open(r),!!s}}return!1}g(e,t){let r;if(!e)r=`${document.location.origin}${document.location.pathname}?${c.a}=true`;else if((0,d.$WD)(e)){const s=this.h(e.folderUri);r=`${document.location.origin}${document.location.pathname}?${c.b}=${s}`}else if((0,d.$VD)(e)){const s=this.h(e.workspaceUri);r=`${document.location.origin}${document.location.pathname}?${c.c}=${s}`}return t?.payload&&(r+=`&${c.d}=${encodeURIComponent(JSON.stringify(t.payload))}`),r}h(e){return this.f.remoteAuthority&&e.scheme===m.Schemas.vscodeRemote?encodeURIComponent(`${g.$ic.sep}${(0,O.$nf)(e.path,g.$ic.sep)}`).replaceAll("%2F","/"):encodeURIComponent(e.toString(!0))}j(e,t){return!e||!t?e===t:(0,d.$WD)(e)&&(0,d.$WD)(t)?(0,U.$_g)(e.folderUri,t.folderUri):(0,d.$VD)(e)&&(0,d.$VD)(t)?(0,U.$_g)(e.workspaceUri,t.workspaceUri):!1}hasRemote(){if(this.workspace){if((0,d.$WD)(this.workspace))return this.workspace.folderUri.scheme===m.Schemas.vscodeRemote;if((0,d.$VD)(this.workspace))return this.workspace.workspaceUri.scheme===m.Schemas.vscodeRemote}return!0}}function G(i){const e=document.cookie.split("; ");for(const t of e)if(t.startsWith(i+"="))return t.substring(i.length+1)}(function(){const i=o.$WR.document.getElementById("vscode-workbench-web-configuration"),e=i?i.getAttribute("data-settings"):void 0;if(!i||!e)throw new Error("Missing web configuration element");const t=JSON.parse(e),r=G("vscode-secret-key-path"),s=r&&E.supported()?new E(r):new H;(0,A.create)(o.$WR.document.body,{...t,windowIndicator:t.windowIndicator??{label:"$(remote)",tooltip:`${$.default.nameShort} Web`},settingsSyncOptions:t.settingsSyncOptions?{enabled:t.settingsSyncOptions.enabled}:void 0,workspaceProvider:c.create(t),urlCallbackProvider:new v(t.callbackRoute),secretStorageProvider:t.remoteAuthority&&!r?void 0:new w(s)})})()})}).call(this);

//# sourceMappingURL=https://main.vscode-cdn.net/sourcemaps/c2e20cb17fae44eb26611cb9a4690059cea0e605/core/vs/code/browser/workbench/workbench.js.map
